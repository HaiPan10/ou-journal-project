<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{layouts/layout}">

<section class="flex justify-center mt-5 mb-12" layout:fragment="content">
    <div class="container min-h-[800px]">
        <a href="javascript:history.back();" class="text-gray-600 flex items-center gap-x-3 mb-5">
            <i class="bi bi-arrow-left"></i> <span>Quay lại</span>
        </a>
        <form th:action="@{/editor/review-articles/invite/{id}(id=${articleId})}" th:object="${user}" method="post"
            class="move-up-anim my-5 p-5 bg-white rounded-lg">
            <div class="grid grid-cols-1 gap-y-5">
                <h1 class="font-semibold uppercase text-lg text-main">Thông tin phản biện viên</h1>
                <div th:if="${#fields.hasAnyErrors()}" class="flex flex-col gap-3">
                    <div class="text-red-500 text-sm font-medium w-fit" th:each="err : ${#fields.allErrors()}"
                        th:text="${err}"></div>
                </div>
                <input type="hidden" id="user-id" th:field="*{id}">
                <div class="relative">
                    <input id="myInput" type="text" th:field="*{email}" class="input-floating peer" placeholder=" " />
                    <label for="myInput" class="label-floating">Email</label>
                </div>
                <span class="text-red-500 text-sm font-medium hidden w-fit mt-1" id="notAvailable">Mail của phản biện
                    viên
                    này
                    chưa có trên hệ thống! Vui lòng nhập họ tên</span>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-5">
                    <div class="col-span-1 relative">
                        <input id="user-last-name" th:field="*{lastName}" name="lastName" required type="text"
                            placeholder=" " class="input-floating peer" />
                        <label for="user-last-name" class="label-floating">Họ và tên đệm</label>

                    </div>
                    <div class="col-span-1 relative">
                        <input id="user-first-name" th:field="*{firstName}" name="firstName" type="text" placeholder=" "
                            required class="input-floating peer" />
                        <label for="user-first-name" class="label-floating">Tên</label>
                    </div>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-5">
                    <div class="col-span-1 relative">
                        <label for="country" class="label-floating">Quốc gia</label>
                        <select name="country" id="user-country" class="input-floating peer">
                            <option value="">Chọn quốc gia</option>
                            <option label="Afganixtan" value="AF">Afganixtan</option>
                            <option label="Anbani" value="AL">Anbani</option>
                            <option label="Andorra" value="AD">Andorra</option>
                            <option label="Angiêri" value="DZ">Angiêri</option>
                            <option label="Anguilla" value="AI">Anguilla</option>
                            <option label="Anh" value="GB">Anh</option>
                            <option label="Anh, Quần đảo Virgin" value="VG">Anh, Quần đảo Virgin</option>
                            <option label="Antarctica" value="AQ">Antarctica</option>
                            <option label="Antigua và Barbuda" value="AG">Antigua và Barbuda</option>
                            <option label="Aruba" value="AW">Aruba</option>
                            <option label="Australia" value="AU">Australia</option>
                            <option label="Azerbaijan" value="AZ">Azerbaijan</option>
                            <option label="Ba Lan" value="PL">Ba Lan</option>
                            <option label="Bahamas" value="BS">Bahamas</option>
                            <option label="Bahrain" value="BH">Bahrain</option>
                            <option label="Bangladesh" value="BD">Bangladesh</option>
                            <option label="Barbados" value="BB">Barbados</option>
                            <option label="Belarus" value="BY">Belarus</option>
                            <option label="Belgium" value="BE">Belgium</option>
                            <option label="Belize" value="BZ">Belize</option>
                            <option label="Benin" value="BJ">Benin</option>
                            <option label="Bermuda" value="BM">Bermuda</option>
                            <option label="Bhugan" value="BT">Bhugan</option>
                            <option label="Bolivia" value="BO">Bolivia</option>
                            <option label="Bosnia and Herzegovina" value="BA">Bosnia and Herzegovina</option>
                            <option label="Botswana" value="BW">Botswana</option>
                            <option label="Bouvet Island" value="BV">Bouvet Island</option>
                            <option label="Brazil" value="BR">Brazil</option>
                            <option label="British Indian Ocean Territory" value="IO">British Indian Ocean
                                Territory
                            </option>
                            <option label="Brunei Darussalam" value="BN">Brunei Darussalam</option>
                            <option label="Bulgaria" value="BG">Bulgaria</option>
                            <option label="Burkina Faso" value="BF">Burkina Faso</option>
                            <option label="Burundi" value="BI">Burundi</option>
                            <option label="Bồ Đào Nha" value="PT">Bồ Đào Nha</option>
                            <option label="Cameroon" value="CM">Cameroon</option>
                            <option label="Campuchia" value="KH">Campuchia</option>
                            <option label="Canada" value="CA">Canada</option>
                            <option label="Cape Verde" value="CV">Cape Verde</option>
                            <option label="Cayman Islands" value="KY">Cayman Islands</option>
                            <option label="Central African Republic" value="CF">Central African Republic
                            </option>
                            <option label="Chad" value="TD">Chad</option>
                            <option label="Chile" value="CL">Chile</option>
                            <option label="China" value="CN">China</option>
                            <option label="Christmas Island" value="CX">Christmas Island</option>
                            <option label="Cocos (Keeling) Islands" value="CC">Cocos (Keeling) Islands</option>
                            <option label="Colombia" value="CO">Colombia</option>
                            <option label="Comoros" value="KM">Comoros</option>
                            <option label="Congo" value="CG">Congo</option>
                            <option label="Congo, The Democratic Republic Of The" value="CD">Congo, The
                                Democratic
                                Republic Of The</option>
                            <option label="Cook Islands" value="CK">Cook Islands</option>
                            <option label="Costa Rica" value="CR">Costa Rica</option>
                            <option label="Croatia" value="HR">Croatia</option>
                            <option label="Cuba" value="CU">Cuba</option>
                            <option label="Cyprus" value="CY">Cyprus</option>
                            <option label="Czech Republic" value="CZ">Czech Republic</option>
                            <option label="Côte d'Ivoire" value="CI">Côte d'Ivoire</option>
                            <option label="Denmark" value="DK">Denmark</option>
                            <option label="Djibouti" value="DJ">Djibouti</option>
                            <option label="Dominica" value="DM">Dominica</option>
                            <option label="Dominican Republic" value="DO">Dominican Republic</option>
                            <option label="Ecuador" value="EC">Ecuador</option>
                            <option label="Egypt" value="EG">Egypt</option>
                            <option label="El Salvador" value="SV">El Salvador</option>
                            <option label="Equatorial Guinea" value="GQ">Equatorial Guinea</option>
                            <option label="Eritrea" value="ER">Eritrea</option>
                            <option label="Estonia" value="EE">Estonia</option>
                            <option label="Ethiopia" value="ET">Ethiopia</option>
                            <option label="Falkland Islands (Malvinas)" value="FK">Falkland Islands (Malvinas)
                            </option>
                            <option label="Faroe Islands" value="FO">Faroe Islands</option>
                            <option label="Fiji" value="FJ">Fiji</option>
                            <option label="French Guiana" value="GF">French Guiana</option>
                            <option label="French Polynesia" value="PF">French Polynesia</option>
                            <option label="French Southern Territories" value="TF">French Southern Territories
                            </option>
                            <option label="Gabon" value="GA">Gabon</option>
                            <option label="Gambia" value="GM">Gambia</option>
                            <option label="Georgia" value="GE">Georgia</option>
                            <option label="Germany" value="DE">Germany</option>
                            <option label="Ghana" value="GH">Ghana</option>
                            <option label="Gibraltar" value="GI">Gibraltar</option>
                            <option label="Greenland" value="GL">Greenland</option>
                            <option label="Grenada" value="GD">Grenada</option>
                            <option label="Guadeloupe" value="GP">Guadeloupe</option>
                            <option label="Guam" value="GU">Guam</option>
                            <option label="Guatemala" value="GT">Guatemala</option>
                            <option label="Guinea" value="GN">Guinea</option>
                            <option label="Guinea-Bissau" value="GW">Guinea-Bissau</option>
                            <option label="Guyana" value="GY">Guyana</option>
                            <option label="Haiti" value="HT">Haiti</option>
                            <option label="Heard Island and McDonald Islands" value="HM">Heard Island and
                                McDonald
                                Islands</option>
                            <option label="Hoa Kỳ" value="US">Hoa Kỳ</option>
                            <option label="Hoa Kỳ, các đảo nhỏ ngoài khơi" value="UM">Hoa Kỳ, các đảo nhỏ ngoài
                                khơi
                            </option>
                            <option label="Holy See (Vatican City State)" value="VA">Holy See (Vatican City
                                State)
                            </option>
                            <option label="Honduras" value="HN">Honduras</option>
                            <option label="Hungary" value="HU">Hungary</option>
                            <option label="Hy Lạp" value="GR">Hy Lạp</option>
                            <option label="Hà Lan" value="NL">Hà Lan</option>
                            <option label="Hàn Quốc, Cộng hòa" value="KR">Hàn Quốc, Cộng hòa</option>
                            <option label="Hồng Kông" value="HK">Hồng Kông</option>
                            <option label="Iceland" value="IS">Iceland</option>
                            <option label="Indonesia" value="ID">Indonesia</option>
                            <option label="Iran, Islamic Republic Of" value="IR">Iran, Islamic Republic Of
                            </option>
                            <option label="Iraq" value="IQ">Iraq</option>
                            <option label="Ireland" value="IE">Ireland</option>
                            <option label="Israel" value="IL">Israel</option>
                            <option label="Italy" value="IT">Italy</option>
                            <option label="Jamaica" value="JM">Jamaica</option>
                            <option label="Jordan" value="JO">Jordan</option>
                            <option label="Kazakhstan" value="KZ">Kazakhstan</option>
                            <option label="Kenya" value="KE">Kenya</option>
                            <option label="Kiribati" value="KI">Kiribati</option>
                            <option label="Kuwait" value="KW">Kuwait</option>
                            <option label="Kyrgyzstan" value="KG">Kyrgyzstan</option>
                            <option label="Latvia" value="LV">Latvia</option>
                            <option label="Lebanon" value="LB">Lebanon</option>
                            <option label="Lesotho" value="LS">Lesotho</option>
                            <option label="Liberia" value="LR">Liberia</option>
                            <option label="Libyan Arab Jamahiriya" value="LY">Libyan Arab Jamahiriya</option>
                            <option label="Liechtenstein" value="LI">Liechtenstein</option>
                            <option label="Lithuania" value="LT">Lithuania</option>
                            <option label="Luxembourg" value="LU">Luxembourg</option>
                            <option label="Lào, CHDCND" value="LA">Lào, CHDCND</option>
                            <option label="Macao" value="MO">Macao</option>
                            <option label="Macedonia, The Former Yugoslav Republic Of" value="MK">Macedonia, The
                                Former Yugoslav Republic Of</option>
                            <option label="Madagascar" value="MG">Madagascar</option>
                            <option label="Malawi" value="MW">Malawi</option>
                            <option label="Malaysia" value="MY">Malaysia</option>
                            <option label="Maldives" value="MV">Maldives</option>
                            <option label="Mali" value="ML">Mali</option>
                            <option label="Malta" value="MT">Malta</option>
                            <option label="Marshall Islands" value="MH">Marshall Islands</option>
                            <option label="Martinique" value="MQ">Martinique</option>
                            <option label="Mauritania" value="MR">Mauritania</option>
                            <option label="Mauritius" value="MU">Mauritius</option>
                            <option label="Mayotte" value="YT">Mayotte</option>
                            <option label="Mexico" value="MX">Mexico</option>
                            <option label="Micronesia, Federated States Of" value="FM">Micronesia, Federated
                                States
                                Of</option>
                            <option label="Moldova, Republic Of" value="MD">Moldova, Republic Of</option>
                            <option label="Monaco" value="MC">Monaco</option>
                            <option label="Montserrat" value="MS">Montserrat</option>
                            <option label="Morocco" value="MA">Morocco</option>
                            <option label="Mozambique" value="MZ">Mozambique</option>
                            <option label="Mynamar" value="MM">Mynamar</option>
                            <option label="Mông Cổ" value="MN">Mông Cổ</option>
                            <option label="Mỹ, Quần đảo Virgin" value="VI">Mỹ, Quần đảo Virgin</option>
                            <option label="Namibia" value="NA">Namibia</option>
                            <option label="Nauru" value="NR">Nauru</option>
                            <option label="Nepal" value="NP">Nepal</option>
                            <option label="Netherlands Antilles" value="AN">Netherlands Antilles</option>
                            <option label="New Caledonia" value="NC">New Caledonia</option>
                            <option label="New Zealand" value="NZ">New Zealand</option>
                            <option label="Nga" value="RU">Nga</option>
                            <option label="Nhật Bản" value="JP">Nhật Bản</option>
                            <option label="Nicaragua" value="NI">Nicaragua</option>
                            <option label="Niger" value="NE">Niger</option>
                            <option label="Nigeria" value="NG">Nigeria</option>
                            <option label="Niue" value="NU">Niue</option>
                            <option label="Norfolk Island" value="NF">Norfolk Island</option>
                            <option label="Northern Mariana Islands" value="MP">Northern Mariana Islands
                            </option>
                            <option label="Norway" value="NO">Norway</option>
                            <option label="Oman" value="OM">Oman</option>
                            <option label="Pakistan" value="PK">Pakistan</option>
                            <option label="Palau" value="PW">Palau</option>
                            <option label="Palestinian Territory, Occupied" value="PS">Palestinian Territory,
                                Occupied</option>
                            <option label="Panama" value="PA">Panama</option>
                            <option label="Papua New Guinea" value="PG">Papua New Guinea</option>
                            <option label="Paraguay" value="PY">Paraguay</option>
                            <option label="Peru" value="PE">Peru</option>
                            <option label="Philippines" value="PH">Philippines</option>
                            <option label="Pháp" value="FR">Pháp</option>
                            <option label="Phần Lan" value="FI">Phần Lan</option>
                            <option label="Pitcairn" value="PN">Pitcairn</option>
                            <option label="Puerto Rico" value="PR">Puerto Rico</option>
                            <option label="Qatar" value="QA">Qatar</option>
                            <option label="Romania" value="RO">Romania</option>
                            <option label="Rwanda" value="RW">Rwanda</option>
                            <option label="Réunion" value="RE">Réunion</option>
                            <option label="Saint Helena" value="SH">Saint Helena</option>
                            <option label="Saint Kitts and Nevis" value="KN">Saint Kitts and Nevis</option>
                            <option label="Saint Lucia" value="LC">Saint Lucia</option>
                            <option label="Saint Pierre and Miquelon" value="PM">Saint Pierre and Miquelon
                            </option>
                            <option label="Saint Vincent and the Grenadines" value="VC">Saint Vincent and the
                                Grenadines</option>
                            <option label="Samoa" value="WS">Samoa</option>
                            <option label="Samoa, Hoa Kỳ" value="AS">Samoa, Hoa Kỳ</option>
                            <option label="San Marino" value="SM">San Marino</option>
                            <option label="Sao Tome and Principe" value="ST">Sao Tome and Principe</option>
                            <option label="Saudi Arabia" value="SA">Saudi Arabia</option>
                            <option label="Senegal" value="SN">Senegal</option>
                            <option label="Serbia and Montenegro" value="CS">Serbia and Montenegro</option>
                            <option label="Seychelles" value="SC">Seychelles</option>
                            <option label="Sierra Leone" value="SL">Sierra Leone</option>
                            <option label="Singapore" value="SG">Singapore</option>
                            <option label="Slovakia" value="SK">Slovakia</option>
                            <option label="Slovenia" value="SI">Slovenia</option>
                            <option label="Solomon Islands" value="SB">Solomon Islands</option>
                            <option label="Somalia" value="SO">Somalia</option>
                            <option label="South Africa" value="ZA">South Africa</option>
                            <option label="South Georgia and the South Sandwich Islands" value="GS">South
                                Georgia
                                and the South Sandwich Islands</option>
                            <option label="Spain" value="ES">Spain</option>
                            <option label="Sri Lanka" value="LK">Sri Lanka</option>
                            <option label="Sudan" value="SD">Sudan</option>
                            <option label="Suriname" value="SR">Suriname</option>
                            <option label="Svalbard and Jan Mayen" value="SJ">Svalbard and Jan Mayen</option>
                            <option label="Swaziland" value="SZ">Swaziland</option>
                            <option label="Syri" value="SY">Syri</option>
                            <option label="Tajikistan" value="TJ">Tajikistan</option>
                            <option label="Tanzania, Cộng hòa Thống nhất" value="TZ">Tanzania, Cộng hòa Thống
                                nhất
                            </option>
                            <option label="Thái Lan" value="TH">Thái Lan</option>
                            <option label="Thổ Nhĩ Kỳ" value="TR">Thổ Nhĩ Kỳ</option>
                            <option label="Thụy Sỹ" value="CH">Thụy Sỹ</option>
                            <option label="Thụy Điển" value="SE">Thụy Điển</option>
                            <option label="Togo" value="TG">Togo</option>
                            <option label="Tokelau" value="TK">Tokelau</option>
                            <option label="Tonga" value="TO">Tonga</option>
                            <option label="Trinidad and Tobago" value="TT">Trinidad and Tobago</option>
                            <option label="Triều Tiên, CHDCND" value="KP">Triều Tiên, CHDCND</option>
                            <option label="Tunisia" value="TN">Tunisia</option>
                            <option label="Turkmenistan" value="TM">Turkmenistan</option>
                            <option label="Turks and Caicos Islands" value="TC">Turks and Caicos Islands
                            </option>
                            <option label="Tuvalu" value="TV">Tuvalu</option>
                            <option label="Tây Sahara" value="EH">Tây Sahara</option>
                            <option label="Uganda" value="UG">Uganda</option>
                            <option label="Ukraine" value="UA">Ukraine</option>
                            <option label="United Arab Emigrates" value="AE">United Arab Emigrates</option>
                            <option label="Uruguay" value="UY">Uruguay</option>
                            <option label="Uzbekistan" value="UZ">Uzbekistan</option>
                            <option label="Vanuatu" value="VU">Vanuatu</option>
                            <option label="Venezuela" value="VE">Venezuela</option>
                            <option label="Việt Nam" value="VN">Việt Nam</option>
                            <option label="Wallis and Futuna" value="WF">Wallis and Futuna</option>
                            <option label="Yêmen" value="YE">Yêmen</option>
                            <option label="Zambia" value="ZM">Zambia</option>
                            <option label="Zimbabwe" value="ZW">Zimbabwe</option>
                            <option label="Áchentina" value="AR">Áchentina</option>
                            <option label="Ácmênia" value="AM">Ácmênia</option>
                            <option label="Áo" value="AT">Áo</option>
                            <option label="Ăngôla" value="AO">Ăngôla</option>
                            <option label="Đài Loan" value="TW">Đài Loan</option>
                            <option label="Đông Timo" value="TL">Đông Timo</option>
                            <option label="Đảo Åland" value="AX">Đảo Åland</option>
                            <option label="Ấn Độ" value="IN">Ấn Độ</option>
                        </select>
                    </div>
                    <div class="col-span-1 relative">
                        <input id="user-work-agency" th:field="*{workAgency}" name="workAgency" type="text"
                            placeholder=" " class="input-floating peer" />
                        <label for="user-work-agency" class="label-floating">Cơ quan công tác</label>

                    </div>
                    <div class="col-span-1 relative">
                        <input id="user-position" th:field="*{position}" name="position" type="text" placeholder=" "
                            class="input-floating peer" />
                        <label for="user-position" class="label-floating">Chức vụ</label>
                    </div>
                </div>
                <button type="submit" class="btn-main ml-auto">
                    Mời reviewer</button>
            </div>
        </form>
        <div th:if="${renderManuscript}"  data-accordion="collapse" class="move-up-anim transition-all rounded-lg bg-white px-5 py-3 my-1"
            data-active-classes="bg-white text-main font-medium">
            <h2 data-accordion-target="#temp-hide" aria-expanded="true" aria-controls="temp-hide">

            </h2>
            <h2 id="dropdown-heading">
                <button data-accordion-target="#file-anonymous-view" aria-expanded="true" aria-controls="file-anonymous-view"
                    class="transition-all w-full flex gap-x-2 items-center py-1 text-main hover:text-main hover:font-medium"
                    type="button">File ẩn danh của bài viêt<i data-accordion-icon
                        class="bi bi-chevron-down rolate-180 transition-all flex justify-center shrink-0"></i>
                </button>
            </h2>

            <div id="temp-hide"></div>
            <!-- Dropdown menu -->
            <div id="file-anonymous-view" class="transition-all hidden">
                <th:block th:if="${#authorization.expression('hasRole(''ROLE_EDITOR'')')}"
                    th:replace="~{fragments/editor/anonymousFile :: anonymousFile}"></th:block>

            </div>
        </div>

        <ul class="move-up-anim tab-block-container w-fit mt-5" id="tabs" data-tabs-toggle="#tab-contents"
            role="tablist">
            <li class="w-fit" role="presentation">
                <button role="tab" class="tab-block" id="current-reviewer-tab" data-tabs-target="#current-reviewer"
                    type="button" aria-controls="current-reviewer" aria-selected="true">Danh sách đã
                    mời</button>
            </li>

            <li class="w-fit" role="presentation">
                <button role="tab" class="tab-block" id="old-reviewer-tab" data-tabs-target="#old-reviewer"
                    type="button" aria-controls="old-reviewer" aria-selected="false">Danh sách từng
                    mời</button>
            </li>
        </ul>

        <div id="tab-contents">
            <div class="move-up-anim table-container my-6" id="current-reviewer" role="tabpanel"
                aria-labelledby="current-reviewer-tab">
                <table class="table">
                    <h3 class="table-header text-lg text-main font-semibold py-5 px-6">
                        Danh sách reviewer đã mời
                    </h3>
                    <thead class="table-header">
                        <tr>
                            <th scope="col" class="px-6 py-3">
                                #
                            </th>
                            <th scope="col" class="px-6 py-3">
                                Mail reviewer
                            </th>
                            <th scope="col" class="px-6 py-3">
                                Họ tên reviewer
                            </th>
                            <th scope="col" class="px-6 py-3">
                                Ngày mời
                            </th>
                            <th scope="col" class="px-6 py-3">
                                Trạng thái mời
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <th:block th:each="reviewArticle : ${reviewArticles}">
                            <tr class="table-row">
                                <td class="px-6 py-4 font-medium text-gray-900" th:text="${reviewArticle.user.id}">
                                </td>
                                <th scope="row" class="px-6 py-4 flex gap-3 items-center">
                                    <span th:text="${reviewArticle.user.email}"></span>
                                </th>
                                <td class="px-6 py-4"
                                    th:text="${reviewArticle.user.lastName} + ' ' + ${reviewArticle.user.firstName}">
                                </td>
                                <td class="px-6 py-4" th:text="${reviewArticle.invitedAt}"></span>
                                </td>
                                <td class="px-6 py-4">
                                    <div th:if="${reviewArticle.status eq 'PENDING'}">
                                        <span class="badge-warning">Chờ phản hồi</span>
                                    </div>
                                    <div th:if="${reviewArticle.status eq 'ACCEPTED'}">
                                        <span class="badge-success">Đồng ý</span>
                                    </div>
                                    <div th:if="${reviewArticle.status eq 'REJECTED'}">
                                        <span class="badge-danger">Từ chối</span>
                                    </div>
                                    <div
                                        th:if="${reviewArticle.status eq 'ACCEPT_PUBLISH' || reviewArticle.status eq 'REJECT_PUBLISH'}">
                                        <span class="badge-success">Đã phản biện</span>
                                    </div>
                                </td>
                            </tr>
                        </th:block>
                    </tbody>
                </table>
            </div>

            <div class="move-up-anim table-container my-6" id="old-reviewer" role="tabpanel"
                aria-labelledby="old-reviewer-tab">
                <table class="table">
                    <h3 class="table-header text-lg text-main font-semibold py-5 px-6">
                        Danh sách reviewer đã mời ở các manuscript trước đó
                    </h3>
                    <thead class="table-header">
                        <tr>
                            <th scope="col" class="px-6 py-3">
                                #
                            </th>
                            <th scope="col" class="px-6 py-3">
                                Mail reviewer
                            </th>
                            <th scope="col" class="px-6 py-3">
                                Họ tên reviewer
                            </th>
                            <th scope="col" class="px-6 py-3">
                                Version Manuscript từng tham gia
                            </th>
                            <th scope="col" class="px-6 py-3">
                                Hành động
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <th:block th:each="reviewer, iStat : ${reviewers}">
                            <tr class="table-row">
                                <td class="px-6 py-4 font-medium text-gray-900" th:text="${reviewer.key.id}">
                                </td>
                                <th scope="row" class="px-6 py-4 flex gap-3 items-center">
                                    <span th:text="${reviewer.key.email}"></span>
                                </th>
                                <td class="px-6 py-4"
                                    th:text="${reviewer.key.lastName} + ' ' + ${reviewer.key.firstName}"></td>
                                <td class="px-6 py-4">
                                    <th:block th:each="reviewArticle : ${reviewer.value}">
                                        <span
                                            th:text="${reviewArticle.manuscript.version + ' - Vòng ' + iStat.index + 1}"></span>
                                        <br>
                                    </th:block>
                                </td>
                                <th scope="col" class="px-6 py-3">
                                    <!-- <a href="#">Mời lại reviewer</a> -->
                                    <button
                                        th:attr="onclick=|reinvite('${reviewer.key.email}', ${reviewer.key.id}, ${articleId})|"
                                        type="button">Mời lại phản biện viên</button>
                                </th>
                            </tr>
                        </th:block>
                    </tbody>
                </table>
            </div>
        </div>


        <!-- <button type="button" id="endInvitationBtn"
            class="move-up-anim rounded-md mt-2 bg-main px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-main/50 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-main/25">
            Tiến hành review</button> -->
    </div>
    <script th:inline="javascript">

        function autocomplete(inp, arr) {
            var currentFocus;
            inp.addEventListener("input", function (e) {
                var a, b, i, val = this.value;
                closeAllLists();
                if (!val) { return false; }
                currentFocus = -1;
                a = document.createElement("DIV");
                a.setAttribute("id", this.id + "autocomplete-list");
                a.setAttribute("class", "autocomplete-items");
                this.parentNode.appendChild(a);
                for (i = 0; i < arr.length; i++) {
                    if (arr[i].substr(0, val.length).toUpperCase() == val.toUpperCase()) {
                        b = document.createElement("DIV");
                        b.innerHTML = "<strong>" + arr[i].substr(0, val.length) + "</strong>";
                        b.innerHTML += arr[i].substr(val.length);
                        b.innerHTML += "<input type='hidden' value='" + arr[i] + "'>";
                        b.addEventListener("click", function (e) {
                            inp.value = this.getElementsByTagName("input")[0].value;
                            checkAvailabe();
                            closeAllLists();
                        });
                        if (a.childElementCount <= 5) {
                            a.appendChild(b);
                        }
                    }
                }
            });
            inp.addEventListener("keydown", function (e) {
                var x = document.getElementById(this.id + "autocomplete-list");
                if (x) x = x.getElementsByTagName("div");
                if (e.keyCode == 40) {
                    currentFocus++;
                    addActive(x);
                } else if (e.keyCode == 38) {
                    currentFocus--;
                    addActive(x);
                } else if (e.keyCode == 13) {
                    e.preventDefault();
                    if (currentFocus > -1) {
                        if (x) x[currentFocus].click();
                    }
                }
            });
            function addActive(x) {
                if (!x) return false;
                removeActive(x);
                if (currentFocus >= x.length) currentFocus = 0;
                if (currentFocus < 0) currentFocus = (x.length - 1);
                x[currentFocus].classList.add("autocomplete-active");
            }
            function removeActive(x) {
                for (var i = 0; i < x.length; i++) {
                    x[i].classList.remove("autocomplete-active");
                }
            }
            function closeAllLists(elmnt) {
                var x = document.getElementsByClassName("autocomplete-items");
                for (var i = 0; i < x.length; i++) {
                    if (elmnt != x[i] && elmnt != inp) {
                        x[i].parentNode.removeChild(x[i]);
                    }
                }
            }
            document.addEventListener("click", function (e) {
                closeAllLists(e.target);
            });
        }

        var users = /*[[${ users }]]*/ "";
        var ids = [];
        var emails = [];
        var lastNames = [];
        var firstNames = [];
        var countries = [];
        var workAgencies = [];
        var positions = [];

        users.forEach(user => {
            ids.push(user[0]);
            emails.push(user[1]);
            lastNames.push(user[2]);
            firstNames.push(user[3]);
            countries.push(user[4]);
            workAgencies.push(user[5]);
            positions.push(user[6]);
            
        });

        autocomplete(document.getElementById("myInput"), emails);

        var input = document.getElementById("myInput");
        input.addEventListener("input", function () {
            checkAvailabe()
        });

        function checkAvailabe() {
            if (input.value.length !== 0) {
                var isAvailableUser = emails.includes(input.value);
                document.getElementById("user-first-name").readOnly = false;
                document.getElementById("user-last-name").readOnly = false;
                if (isAvailableUser) {
                    var index = emails.indexOf(input.value)
                    document.getElementById("myInput").classList.remove("border-red-500");
                    document.getElementById("notAvailable").classList.add("hidden");
                    document.getElementById("user-last-name").value = lastNames[index];
                    document.getElementById("user-first-name").value = firstNames[index];
                    document.getElementById("user-id").value = ids[index];
                    var dropDown = document.getElementById("user-country")
                    dropDown.selectedIndex = 0;
                    for(var i, j = 0; i = dropDown.options[j]; j++){
                        if(i.value === countries[index]){
                            dropDown.selectedIndex = j;
                            break;
                        }
                    }
                    document.getElementById("user-work-agency").value = workAgencies[index];
                    document.getElementById("user-position").value = positions[index];
                    document.getElementById("user-last-name").readOnly = true;
                    document.getElementById("user-first-name").readOnly = true;
                } else {
                    document.getElementById("notAvailable").classList.remove("hidden");
                    document.getElementById("myInput").classList.add("border-red-500");
                    document.getElementById("user-last-name").readOnly = false;
                    document.getElementById("user-first-name").readOnly = false;
                    document.getElementById("user-last-name").value = "";
                    document.getElementById("user-first-name").value = "";
                    document.getElementById("user-country").selectedIndex = 0;
                    document.getElementById("user-work-agency").value = "";
                    document.getElementById("user-position").value = "";
                    document.getElementById("user-id").value = null;
                }
            } else {
                document.getElementById("user-first-name").readOnly = true;
                document.getElementById("user-last-name").readOnly = true;
                document.getElementById("notAvailable").classList.add("hidden");
                document.getElementById("myInput").classList.remove("border-red-500");
            }
        }

        // document.getElementById('endInvitationBtn').addEventListener('click', (e) => {
        //     fetch(`/editor/articles/end-review/[[${article.id}]]`, {
        //         method: 'PUT',
        //         headers: {
        //             'Content-Type': 'application/json'
        //         },
        //     }).then(res => {
        //         if (res.ok) {
        //             window.location.href = `/editor/articles?status=IN_REVIEW`
        //         } else {
        //             return res.text().then(errorMessage => {
        //                 throw new Error(errorMessage);
        //             });
        //         }
        //     }).catch(err => {
        //         alert(err.message)
        //     })
        // })

        function reinvite(reviewerEmail, reviewerId, articleId) {
            fetch(`/api/review-articles/reviewer/reinvite/${articleId}`, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    id: reviewerId,
                    email: reviewerEmail
                })
            }).then(res => {
                if (res.ok) {
                    alert('Mời lại phản biện viên thành công')
                    window.location.reload()
                } else {
                    alert('Oops! Something wrongs')
                }
            })
        }
    </script>
</section>

</html>